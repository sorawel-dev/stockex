<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire du wizard Excel -->
    <record id="view_import_excel_wizard_form" model="ir.ui.view">
        <field name="name">stockex.import.excel.wizard.form</field>
        <field name="model">stockex.import.excel.wizard</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group>
                            <field name="name" placeholder="Ex: Inventaire Mensuel Octobre 2025"/>
                            <field name="date"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                        </group>
                        <group>
                            <field name="file" filename="filename"/>
                            <field name="filename" invisible="1"/>
                            <field name="auto_detect_sheet"/>
                            <field name="sheet_name" invisible="auto_detect_sheet" required="not auto_detect_sheet" placeholder="Ex: Donn√©es Inventaire, articles, Sheet1"/>
                        </group>
                    </group>
                    
                    <group string="Options d'import">
                        <group>
                            <field name="create_missing_products"/>
                            <field name="create_missing_locations"/>
                            <field name="import_geolocation"/>
                        </group>
                        <group>
                            <field name="update_product_prices"/>
                        </group>
                    </group>
                    
                    <notebook>
                        <page string="üìã Instructions" name="instructions">
                            <group>
                                <div class="alert alert-info" role="alert">
                                    <h4>Comment importer votre fichier Excel :</h4>
                                    <ol>
                                        <li><strong>S√©lectionnez votre fichier Excel</strong> (.xlsx) contenant les donn√©es d'inventaire</li>
                                        <li><strong>D√©tection automatique de la feuille</strong> :
                                            <ul>
                                                <li>‚úÖ <strong>Recommand√©</strong> : Laissez "D√©tecter automatiquement" coch√© pour utiliser la premi√®re feuille</li>
                                                <li>Ou d√©cochez et sp√©cifiez le nom exact de la feuille (ex: "articles", "Donn√©es Inventaire")</li>
                                            </ul>
                                        </li>
                                        <li><strong>Configurez les options</strong> selon vos besoins</li>
                                        <li><strong>Pr√©visualisez</strong> pour v√©rifier les donn√©es</li>
                                        <li><strong>Importez</strong> pour cr√©er l'inventaire</li>
                                    </ol>
                                    
                                    <h4>Format attendu du fichier Excel :</h4>
                                    <p>Le fichier doit contenir les colonnes suivantes :</p>
                                    <ul>
                                        <li><code>CODE PRODUIT</code> : Code article (obligatoire)</li>
                                        <li><code>PRODUIT</code> : D√©signation de l'article</li>
                                        <li><code>CODE ENTREPOT</code> : Code de l'emplacement (obligatoire)</li>
                                        <li><code>ENTREPOT</code> : Nom de l'emplacement</li>
                                        <li><code>QUANTITE</code> : Quantit√© inventori√©e</li>
                                        <li><code>COUT UNITAIRE</code> : Prix unitaire (optionnel)</li>
                                        <li><code>UDM</code> : Unit√© de mesure</li>
                                        <li><code>LATITUDE</code> : Latitude GPS (optionnel)</li>
                                        <li><code>LONGITUDE</code> : Longitude GPS (optionnel)</li>
                                        <li><code>VILLE</code> : Ville de l'emplacement (optionnel)</li>
                                        <li><code>ADRESSE</code> : Adresse compl√®te (optionnel)</li>
                                        <li><code>TELEPHONE</code> : T√©l√©phone (optionnel)</li>
                                    </ul>
                                    
                                    <h4>‚öôÔ∏è Options disponibles :</h4>
                                    <ul>
                                        <li><strong>Cr√©er les produits manquants</strong> : Les produits non trouv√©s seront cr√©√©s automatiquement</li>
                                        <li><strong>Cr√©er les emplacements manquants</strong> : Les emplacements non trouv√©s seront cr√©√©s automatiquement</li>
                                        <li><strong>Importer la g√©olocalisation</strong> : Les coordonn√©es GPS et informations de contact seront import√©es</li>
                                        <li><strong>Mettre √† jour les prix</strong> : Les prix des produits existants seront mis √† jour</li>
                                    </ul>
                                </div>
                            </group>
                        </page>
                        
                        <page string="üí° Conseils" name="tips">
                            <group>
                                <div class="alert alert-warning" role="alert">
                                    <h4>Conseils pour un import r√©ussi :</h4>
                                    <ul>
                                        <li>‚úÖ Assurez-vous que les codes produits correspondent √† ceux de votre base Odoo</li>
                                        <li>‚úÖ V√©rifiez que les emplacements existent ou activez l'option de cr√©ation automatique</li>
                                        <li>‚úÖ Les quantit√©s doivent √™tre des nombres (pas de texte)</li>
                                        <li>‚úÖ Utilisez le bouton "Pr√©visualiser" avant d'importer pour v√©rifier les donn√©es</li>
                                        <li>‚úÖ Pour les gros fichiers (>1000 lignes), l'import peut prendre quelques minutes</li>
                                        <li>‚ö†Ô∏è L'import cr√©e un inventaire en brouillon que vous devrez valider manuellement</li>
                                    </ul>
                                    
                                    <h4>En cas d'erreur :</h4>
                                    <ul>
                                        <li>Les lignes en erreur seront ignor√©es</li>
                                        <li>Un r√©sum√© des erreurs sera affich√© √† la fin de l'import</li>
                                        <li>Vous pourrez corriger les erreurs et r√©importer si n√©cessaire</li>
                                    </ul>
                                </div>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                
                <footer>
                    <button string="üîç Pr√©visualiser" name="action_preview" type="object" class="btn-secondary"/>
                    <button string="üì• Importer" name="action_import" type="object" class="btn-primary"/>
                    <button string="Annuler" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action pour ouvrir le wizard -->
    <record id="action_import_excel_wizard" model="ir.actions.act_window">
        <field name="name">Import Excel d'Inventaire</field>
        <field name="res_model">stockex.import.excel.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_stockex_stock_inventory"/>
        <field name="binding_view_types">list</field>
    </record>

</odoo>
