<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire du wizard de correction -->
    <record id="view_fix_locations_wizard_form" model="ir.ui.view">
        <field name="name">stockex.fix.locations.wizard.form</field>
        <field name="model">stockex.fix.locations.wizard</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <div class="alert alert-warning" role="alert">
                        <h4>‚ö†Ô∏è Probl√®me d√©tect√©</h4>
                        <p>
                            <strong><field name="bad_locations_count"/> emplacements</strong> ne sont pas de type 'internal'
                            et ne peuvent pas √™tre utilis√©s pour les stocks.
                        </p>
                    </div>
                    
                    <group>
                        <field name="inventory_id" invisible="1"/>
                    </group>
                    
                    <notebook>
                        <page string="üìã Emplacements √† Corriger" name="details">
                            <field name="bad_locations_info" nolabel="1" readonly="1"/>
                        </page>
                        
                        <page string="üí° Solution" name="solution">
                            <div class="alert alert-info">
                                <h4>Comment corriger ?</h4>
                                <ol>
                                    <li><strong>Automatique</strong> : Cliquer sur "Corriger et Revalider" pour convertir automatiquement tous les emplacements</li>
                                    <li><strong>Manuel</strong> : Aller dans Configuration ‚Üí Emplacements et modifier le type de chaque emplacement</li>
                                </ol>
                                
                                <h5>Pourquoi ce probl√®me ?</h5>
                                <p>
                                    Les entrep√¥ts (stock.warehouse) cr√©ent automatiquement des emplacements de type 'internal' (WH/Stock).
                                    Vos lignes d'inventaire pointent probablement vers des emplacements de type 'view' ou autre,
                                    qui ne peuvent pas contenir de stock.
                                </p>
                                
                                <h5>Solution recommand√©e :</h5>
                                <p>
                                    <strong>Utiliser les entrep√¥ts Odoo standards</strong> plut√¥t que des emplacements directs.
                                    Le module a √©t√© configur√© pour utiliser automatiquement le lot_stock_id des entrep√¥ts.
                                </p>
                            </div>
                        </page>
                    </notebook>
                </sheet>
                
                <footer>
                    <button string="‚úÖ Corriger et Revalider" 
                            name="action_revalidate_inventory" 
                            type="object" 
                            class="btn-primary"/>
                    <button string="Juste Corriger" 
                            name="action_fix_locations" 
                            type="object" 
                            class="btn-secondary"/>
                    <button string="Annuler" special="cancel" class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Action pour lancer le wizard -->
    <record id="action_fix_locations_wizard" model="ir.actions.act_window">
        <field name="name">Corriger les Emplacements</field>
        <field name="res_model">stockex.fix.locations.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="model_stockex_stock_inventory"/>
        <field name="binding_view_types">form</field>
    </record>
    
</odoo>
