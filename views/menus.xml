<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Menu racine Stockex -->
    <menuitem id="menu_stockex_root"
              name="Gestion Inventaire"
              sequence="20"
              web_icon="stockex,static/description/icon.png"
              groups="base.group_user"/>

    <!-- Sous-menu : Op√©rations -->
    <menuitem id="menu_stockex_operations"
              name="‚öôÔ∏è Op√©rations"
              parent="menu_stockex_root"
              sequence="10"/>
    
    <menuitem id="menu_stockex_inventory"
              name="üì¶ Inventaires de Stock"
              parent="menu_stockex_operations"
              action="stockex.action_stockex_inventory"
              sequence="10"
              groups="base.group_user"/>
    
    <!-- Liste des stocks initiaux (inventaires marqu√©s comme stock initial) -->
    <record id="action_stockex_initial_inventory_list" model="ir.actions.act_window">
        <field name="name">Liste des stocks initiaux</field>
        <field name="res_model">stockex.stock.inventory</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[("is_initial_stock", "=", True)]</field>
    </record>
    
    <menuitem id="menu_stockex_initial_inventory_list"
              name="üìÇ Liste des stocks initiaux"
              parent="menu_stockex_operations"
              action="action_stockex_initial_inventory_list"
              sequence="15"
              groups="base.group_system"/>
    
    <!-- Action Stock Initial (d√©finie ici pour √©viter les probl√®mes de r√©f√©rence) -->
    <record id="action_initial_stock_wizard_menu" model="ir.actions.act_window">
        <field name="name">Stock Initial</field>
        <field name="res_model">stockex.initial.stock.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>
    
    <menuitem id="menu_initial_stock_wizard"
              name="üì¶ Stock Initial"
              parent="menu_stockex_operations"
              action="action_initial_stock_wizard_menu"
              sequence="20"
              groups="base.group_user"/>
    
    <menuitem id="menu_import_flexible_inventory"
              name="üì• Import Inventaire (Excel/CSV)"
              parent="menu_stockex_operations"
              action="action_import_flexible_inventory_wizard"
              sequence="30"
              groups="base.group_user"/>
    
    <!-- Sous-menu : Configuration -->
    <menuitem id="menu_stockex_config"
              name="‚öôÔ∏è Configuration"
              parent="menu_stockex_root"
              sequence="90"/>
    
    <!-- Menu Param√®tres -->
    <menuitem id="menu_stockex_settings"
              name="‚öôÔ∏è Param√®tres"
              parent="menu_stockex_config"
              action="action_stockex_config_settings"
              sequence="5"
              groups="base.group_user"/>
    
    <!-- Menu vers les Entrep√¥ts Odoo -->
    <menuitem id="menu_stockex_warehouses"
              name="üè¢ Entrep√¥ts"
              parent="menu_stockex_config"
              action="action_warehouse_stockex"
              sequence="10"
              groups="stock.group_stock_user,stockex.group_stockex_user,stockex.group_stockex_manager"/>
    
    <!-- Action R√©seaux Interconnect√©s ENEO -->
    <record id="action_eneo_network_menu" model="ir.actions.act_window">
        <field name="name">R√©seaux Interconnect√©s</field>
        <field name="res_model">stockex.eneo.network</field>
        <field name="view_mode">list,form</field>
        <field name="context">{'search_default_active': 1}</field>
    </record>
    
    <!-- Menu R√©seaux Interconnect√©s ENEO -->
    <menuitem id="menu_stockex_eneo_regions"
              name="‚ö° R√©seaux Interconnect√©s"
              parent="menu_stockex_config"
              action="action_eneo_network_menu"
              sequence="12"
              groups="base.group_user"/>
    
    <!-- Action R√©gions √âlectriques ENEO -->
    <record id="action_eneo_region_menu" model="ir.actions.act_window">
        <field name="name">R√©gions √âlectriques ENEO</field>
        <field name="res_model">stockex.eneo.region</field>
        <field name="view_mode">list,form</field>
        <field name="context">{'search_default_active': 1}</field>
    </record>
    
    <!-- Menu R√©gions √âlectriques ENEO -->
    <menuitem id="menu_stockex_eneo_regions_list"
              name="üó∫Ô∏è R√©gions √âlectriques ENEO"
              parent="menu_stockex_config"
              action="action_eneo_region_menu"
              sequence="11"
              groups="base.group_user"/>
    
    <!-- Menu vers les Emplacements Odoo -->
    <menuitem id="menu_stockex_locations"
              name="üìç Emplacements"
              parent="menu_stockex_config"
              action="stock.action_location_form"
              sequence="20"
              groups="stock.group_stock_user,stockex.group_stockex_user,stockex.group_stockex_manager"/>
    
    <!-- Action pour les produits -->
    <menuitem id="menu_stockex_products"
              name="üì¶ Produits"
              parent="menu_stockex_config"
              action="stockex.action_product_config_stockex"
              sequence="30"
              groups="base.group_user"/>
    
    <!-- Menu Cat√©gories de produits -->
    <menuitem id="menu_stockex_product_categories"
              name="üìÇ Cat√©gories de Produits"
              parent="menu_stockex_config"
              action="product.product_category_action_form"
              sequence="35"
              groups="base.group_user"/>
    
    <!-- Configuration Kobo Collect -->
    <menuitem id="menu_stockex_kobo_config"
              name="üì± Kobo Collect"
              parent="menu_stockex_config"
              action="action_kobo_config"
              sequence="40"
              groups="stockex.group_stockex_user,stockex.group_stockex_manager"/>
    
    <!-- Configuration MinIO -->
    <record id="action_stockex_minio_config" model="ir.actions.act_window">
        <field name="name">Configuration MinIO</field>
        <field name="res_model">res.config.settings</field>
        <field name="view_mode">form</field>
        <field name="target">current</field>
        <field name="context">{'module': 'stockex'}</field>
    </record>
    
    <menuitem id="menu_stockex_minio_config"
              name="üì¶ Stockage MinIO"
              parent="menu_stockex_config"
              action="action_stockex_minio_config"
              sequence="41"
              groups="base.group_system"/>
    
    <!-- Menu Corriger Types Produits (wizard) -->
    <menuitem id="menu_fix_product_types"
              name="üîß Corriger Types Produits"
              parent="menu_stockex_config"
              action="action_fix_product_types_wizard"
              sequence="25"/>
    
    <!-- Menu Configurer Comptes OHADA (wizard) -->
    <menuitem id="menu_stock_accounts_config_wizard"
              name="‚öôÔ∏è Configurer Comptes OHADA"
              parent="menu_stockex_config"
              action="action_stock_accounts_config_wizard"
              sequence="26"
              groups="stockex.group_stockex_manager"/>
    
    <!-- S√©parateur -->
    <menuitem id="menu_stockex_config_separator"
              name="‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
              parent="menu_stockex_config"
              sequence="45"/>
    
    <!-- Action Guide Utilisateur -->
    <record id="action_user_guide" model="ir.actions.act_url">
        <field name="name">Guide Utilisateur</field>
        <field name="url">/stockex/static/description/guide_utilisateur.html</field>
        <field name="target">new</field>
    </record>
    
    <!-- Menu Guide Utilisateur -->
    <menuitem id="menu_stockex_user_guide"
              name="üìñ Guide Utilisateur"
              parent="menu_stockex_config"
              action="action_user_guide"
              sequence="50"
              groups="base.group_user"/>
    
    <!-- Sous-menu : Analyse (utilise les menus natifs d'Odoo) -->
    <menuitem id="menu_stockex_reporting"
              name="üìà Analyse"
              parent="menu_stockex_root"
              sequence="80"/>
    
    <!-- Menus Analyse -->
    
    <!-- Action personnalis√©e pour les quants en stock -->
    <record id="action_stockex_stock_quants" model="ir.actions.act_window">
        <field name="name">Stock par Emplacement</field>
        <field name="res_model">stock.quant</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('quantity', '!=', 0)]</field>
        <field name="context">{
            'search_default_productgroup': 1,
            'search_default_locationgroup': 1,
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Aucun stock disponible
            </p>
        </field>
    </record>
    
    <!-- Menu d√©sactiv√© : Stock par Emplacement
    <menuitem id="menu_stockex_stock_analysis"
              name="üì¶ Stock"
              parent="menu_stockex_reporting"
              action="action_stockex_stock_quants"
              sequence="5"
              groups="stock.group_stock_user,stockex.group_stockex_user,stockex.group_stockex_manager"/>
    -->
    
    <!-- Action pour Analyse des mouvements -->
    <record id="action_stock_move_analysis" model="ir.actions.act_window">
        <field name="name">Analyse des mouvements</field>
        <field name="res_model">stock.move</field>
        <field name="view_mode">list,form,pivot,graph</field>
        <field name="domain">[('state', '=', 'done')]</field>
        <field name="context">{
            'search_default_done': 1,
            'search_default_groupby_product': 1,
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Aucun mouvement de stock
            </p>
        </field>
    </record>
    
    <menuitem id="menu_stockex_moves_analysis"
              name="üìä Analyse des mouvements"
              parent="menu_stockex_reporting"
              action="action_stock_move_analysis"
              sequence="7"
              groups="stock.group_stock_user,stockex.group_stockex_user,stockex.group_stockex_manager"/>
    
    <menuitem id="menu_stockex_inventory_report"
              name="üìã Liste des Inventaires"
              parent="menu_stockex_reporting"
              action="stockex.action_stockex_inventory"
              sequence="10"
              groups="base.group_user"/>
    
    <!-- Menu d√©sactiv√© : Analyse des Stocks
    <menuitem id="menu_stock_analysis"
              name="üìà Analyse des Stocks"
              parent="menu_stockex_reporting"
              sequence="12"
              groups="base.group_user"/>
    -->
    
    <!-- Menu d√©sactiv√© : Rapport de D√©cote
    <menuitem id="menu_depreciation_report"
              name="üìâ Rapport de D√©cote"
              parent="menu_stockex_reporting"
              action="action_depreciation_report"
              sequence="15"/>
    -->
    
    <!-- Menu lots expirants : action comment√©e car n√©cessite module product_expiry -->
    <!--
    <menuitem id="menu_stock_lot_expiring"
              name="Lots Expirant"
              parent="menu_stockex_reporting"
              action="action_stock_lot_expiring"
              sequence="50"/>
    -->
    
    <!-- S√©parateur -->
    <menuitem id="menu_stockex_reports_separator"
              name="‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ"
              parent="menu_stockex_reporting"
              sequence="50"/>
    
    <!-- Action h√©rit√©e pour Valorisation avec filtre quantit√© > 0 -->
    <record id="action_product_stock_view_filtered" model="ir.actions.act_window">
        <field name="name">Valorisation du stock</field>
        <field name="res_model">product.product</field>
        <field name="view_mode">list,form</field>
        <field name="domain">[('qty_available', '!=', 0)]</field>
        <field name="context">{
            'search_default_consumable': 1,
            'search_default_real_stock_available': 1,
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Aucun produit en stock
            </p>
        </field>
    </record>
    
    <!-- Menu d√©sactiv√© : Valorisation du stock
    <menuitem id="menu_stockex_stock_products"
              name="üí∞ Valorisation du stock"
              parent="menu_stockex_reporting"
              action="action_product_stock_view_filtered"
              sequence="65"
              groups="stock.group_stock_user,stockex.group_stockex_user,stockex.group_stockex_manager"/>
    -->
    
    <!-- D√âSACTIV√â - dashboard_home_views.xml incompatible avec Odoo 19 -->
    
</odoo>