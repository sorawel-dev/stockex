<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- Vue formulaire du wizard de nettoyage -->
    <record id="view_stock_data_cleanup_wizard_form" model="ir.ui.view">
        <field name="name">stockex.stock.data.cleanup.wizard.form</field>
        <field name="model">stockex.stock.data.cleanup.wizard</field>
        <field name="arch" type="xml">
            <form string="üóëÔ∏è R√©initialisation des Donn√©es de Stock" class="o_cleanup_wizard">
                <sheet>
                    
                    <!-- Bandeau d'avertissement -->
                    <div class="alert alert-danger" role="alert">
                        <h4 class="alert-heading">
                            üîí ACC√àS STRICTEMENT R√âSERV√â AUX ADMINISTRATEURS
                        </h4>
                        <p class="mb-2">
                            <strong>Cette action supprimera d√©finitivement les donn√©es s√©lectionn√©es.</strong>
                        </p>
                        <hr/>
                        <p class="mb-2">
                            ‚ö° <strong>Il est FORTEMENT recommand√© de faire une sauvegarde</strong> avant de continuer.
                        </p>
                        <p class="mb-0">
                            üìß <strong>Des notifications seront envoy√©es automatiquement</strong> par email et Telegram (si configur√©) √† tous les administrateurs apr√®s l'ex√©cution.
                        </p>
                    </div>
                    
                    <!-- En-t√™te -->
                    <div class="oe_title mb-4 text-center">
                        <h1>üóëÔ∏è Assistant de Nettoyage des Donn√©es</h1>
                        <p class="text-muted" style="font-size: 1.1rem;">
                            S√©lectionnez les types de donn√©es √† supprimer et confirmez l'op√©ration
                        </p>
                    </div>
                    
                    <div class="container-fluid">
                        <div class="row justify-content-center">
                            <div class="col-12 col-lg-10 col-xl-8">
                                <group string="üìä Statistiques Actuelles" class="border p-3 rounded bg-light">
                                    <div class="row">
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="products_count" class="fw-bold d-block"/>
                                            <field name="products_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="categories_count" class="fw-bold d-block"/>
                                            <field name="categories_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="moves_count" class="fw-bold d-block"/>
                                            <field name="moves_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="warehouses_count" class="fw-bold d-block"/>
                                            <field name="warehouses_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="locations_count" class="fw-bold d-block"/>
                                            <field name="locations_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                        <div class="col-6 col-md-4 text-center mb-3">
                                            <label for="inventories_count" class="fw-bold d-block"/>
                                            <field name="inventories_count" readonly="1" class="text-primary fw-bold d-block"/>
                                        </div>
                                    </div>
                                </group>
                            </div>
                        </div>
                    </div>
                    
                    <notebook>
                        <!-- Onglet Options de suppression -->
                        <page string="üéØ Options de Suppression" name="options">
                            <div class="container-fluid">
                                <div class="row justify-content-center mt-3">
                                    <div class="col-12 col-lg-11 col-xl-10">
                                        <div class="row">
                                            <div class="col-12 col-md-6">
                                    <group string="üì¶ DONN√âES DE STOCK" class="mb-4">
                                        <div class="row">
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_inventories" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üìã</span>
                                                        <strong>Supprimer les Inventaires StockEx</strong>
                                                    </label>
                                                    <field name="delete_inventories" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_stock_moves" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üì¶</span>
                                                        <strong>Supprimer les Mouvements de Stock</strong>
                                                    </label>
                                                    <field name="delete_stock_moves" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_locations" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üìç</span>
                                                        <strong>Supprimer les Emplacements</strong>
                                                    </label>
                                                    <field name="delete_locations" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_warehouses" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üè≠</span>
                                                        <strong>Supprimer les Entrep√¥ts</strong>
                                                    </label>
                                                    <field name="delete_warehouses" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                        </div>
                                    </group>
                                </div>
                                
                                            <div class="col-12 col-md-6">
                                    <group string="üè∑Ô∏è DONN√âES PRODUITS" class="mb-4">
                                        <div class="row">
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_products" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üè∑Ô∏è</span>
                                                        <strong>Supprimer les Produits</strong>
                                                    </label>
                                                    <field name="delete_products" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                            <div class="col-12 mb-3">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <label for="delete_categories" class="d-flex align-items-center mb-0">
                                                        <span class="me-2" style="font-size: 1.5rem;">üìÅ</span>
                                                        <strong>Supprimer les Cat√©gories</strong>
                                                    </label>
                                                    <field name="delete_categories" widget="boolean_toggle" nolabel="1"/>
                                                </div>
                                            </div>
                                        </div>
                                    </group>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <separator string="" class="mt-4 mb-4"/>
                            
                            <div class="text-center p-4" style="background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 100%); border-radius: 15px; border: 3px dashed #dc3545;">
                                <label for="delete_all" style="font-size: 1.3rem; color: #dc3545; font-weight: 900;">
                                    ‚ö†Ô∏è TOUT SUPPRIMER (DANGER MAXIMUM)
                                </label>
                                <field name="delete_all" widget="boolean_toggle" nolabel="1" class="fw-bold text-danger"/>
                                <p class="mt-2 mb-0 text-danger"><small><em>Active automatiquement toutes les options ci-dessus</em></small></p>
                            </div>
                            
                            <!-- Informations sur les suppressions -->
                            <div class="alert alert-info mt-3" role="alert">
                                <h5>‚ÑπÔ∏è Informations Importantes</h5>
                                <ul class="mb-0">
                                    <li><strong>Produits :</strong> Seuls les produits sans mouvements valid√©s seront supprim√©s</li>
                                    <li><strong>Cat√©gories :</strong> Seules les cat√©gories vides (sans produits) seront supprim√©es</li>
                                    <li><strong>Mouvements :</strong> Tous les mouvements de stock et pickings seront supprim√©s</li>
                                    <li><strong>Entrep√¥ts :</strong> Supprime les r√®gles de r√©approvisionnement, routes et r√®gles de stock avant les entrep√¥ts. L'entrep√¥t principal sera conserv√©</li>
                                    <li><strong>Emplacements :</strong> Supprime les routes et r√®gles de stock avant les emplacements. Les emplacements syst√®me seront conserv√©s</li>
                                    <li><strong>Inventaires :</strong> Tous les inventaires StockEx seront supprim√©s</li>
                                </ul>
                            </div>
                            
                            <div class="alert alert-warning mt-2" role="alert">
                                <strong>‚ö†Ô∏è Important :</strong> La suppression des emplacements ou entrep√¥ts supprimera √©galement toutes les r√®gles de stock et routes associ√©es dans Odoo.
                            </div>
                        </page>
                        
                        <!-- Onglet Confirmation -->
                        <page string="‚úÖ Confirmation" name="confirmation">
                            <group>
                                <group>
                                    <div class="alert alert-warning" role="alert">
                                        <h5 class="alert-heading">üîí Confirmation de S√©curit√©</h5>
                                        <p>
                                            Pour confirmer cette action <strong>IRR√âVERSIBLE</strong>, 
                                            veuillez taper exactement le mot :
                                        </p>
                                        <h3 class="text-center my-3">
                                            <span class="badge bg-danger">SUPPRIMER</span>
                                        </h3>
                                        <p class="mb-0">
                                            (en majuscules, sans accents ni espaces)
                                        </p>
                                    </div>
                                    
                                    <field name="confirmation_text" 
                                           placeholder="Tapez 'SUPPRIMER' ici"
                                           class="fw-bold"
                                           style="font-size: 1.2rem; text-align: center;"/>
                                </group>
                            </group>
                            
                            <div class="alert alert-secondary mt-3" role="alert">
                                <h6>üìã Checklist Avant Suppression</h6>
                                <ul class="mb-0">
                                    <li>‚òëÔ∏è J'ai v√©rifi√© les options s√©lectionn√©es</li>
                                    <li>‚òëÔ∏è J'ai fait une sauvegarde de la base de donn√©es</li>
                                    <li>‚òëÔ∏è J'ai inform√© les utilisateurs concern√©s</li>
                                    <li>‚òëÔ∏è Je comprends que cette action est irr√©versible</li>
                                </ul>
                            </div>
                        </page>
                    </notebook>
                    
                </sheet>
                
                <!-- Boutons de pied de page -->
                <footer>
                    <button string="üóëÔ∏è SUPPRIMER LES DONN√âES" 
                            name="action_cleanup" 
                            type="object" 
                            class="btn-danger"/>
                    <button string="Annuler" 
                            name="action_cancel" 
                            type="object" 
                            class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>
    
    <!-- Action pour ouvrir le wizard -->
    <record id="action_stock_data_cleanup_wizard" model="ir.actions.act_window">
        <field name="name">üóëÔ∏è R√©initialisation des Donn√©es</field>
        <field name="res_model">stockex.stock.data.cleanup.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="binding_model_id" ref="stock.model_stock_warehouse"/>
    </record>
    
    <!-- Menu sous Configuration StockEx - STRICTEMENT ADMINISTRATEURS -->
    <menuitem id="menu_stock_data_cleanup"
              name="üóëÔ∏è R√©initialisation des Donn√©es"
              parent="menu_stockex_config"
              action="action_stock_data_cleanup_wizard"
              sequence="99"
              groups="base.group_system"/>
    
</odoo>
